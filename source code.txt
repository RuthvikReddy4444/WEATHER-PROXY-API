==========================================
 WEATHER PROJECT SOURCE CODE (TEXT FILE)
==========================================

PROJECT: Weather Proxy API (Node.js + Express + Frontend)


==========================================
 backend/package.json
==========================================
{
  "name": "weather-proxy-api",
  "version": "1.0.0",
  "description": "Node.js Weather Proxy API",
  "main": "src/index.js",
  "scripts": {
    "start": "node src/index.js",
    "dev": "nodemon src/index.js",
    "test": "echo \"No tests configured\""
  },
  "dependencies": {
    "axios": "^1.4.0",
    "cors": "^2.8.5",
    "dotenv": "^16.3.1",
    "express": "^4.18.2"
  },
  "devDependencies": {
    "nodemon": "^2.0.22"
  }
}


==========================================
 backend/.env.example
==========================================
OPENWEATHER_API_KEY=your_openweather_api_key_here
PORT=3001


==========================================
 backend/src/index.js
==========================================
require('dotenv').config();
const express = require('express');
const cors = require('cors');
const weatherRouter = require('./routes/weather');

const app = express();
app.use(cors());
app.use(express.json());

app.get('/health', (req, res) => res.json({ status: 'ok' }));

app.use('/weather', weatherRouter);

const PORT = process.env.PORT || 3001;
app.listen(PORT, () => console.log(`Server running on ${PORT}`));


==========================================
 backend/src/weatherClient.js
==========================================
const axios = require('axios');

const OPENWEATHER_KEY = process.env.OPENWEATHER_API_KEY;
const baseUrl = "https://api.openweathermap.org/data/2.5";

async function fetchByCity(city) {
  const url = baseUrl + "/weather";
  const params = { q: city, appid: OPENWEATHER_KEY, units: "metric" };
  const resp = await axios.get(url, { params });
  return resp.data;
}

async function fetchByCoords(lat, lon) {
  const url = baseUrl + "/weather";
  const params = { lat, lon, appid: OPENWEATHER_KEY, units: "metric" };
  const resp = await axios.get(url, { params });
  return resp.data;
}

function reformatOpenWeatherData(raw) {
  if (!raw || !raw.main) return null;

  return {
    city: raw.name,
    country: raw.sys?.country,
    coord: raw.coord,
    temperature: raw.main.temp,
    feels_like: raw.main.feels_like,
    temp_min: raw.main.temp_min,
    temp_max: raw.main.temp_max,
    humidity: raw.main.humidity,
    pressure: raw.main.pressure,
    wind: raw.wind?.speed,
    visibility: raw.visibility,
    clouds: raw.clouds?.all,
    sunrise: raw.sys?.sunrise * 1000,
    sunset: raw.sys?.sunset * 1000,
    description: raw.weather?.[0]?.description,
    icon: raw.weather?.[0]?.icon
  };
}

module.exports = {
  fetchByCity,
  fetchByCoords,
  reformatOpenWeatherData
};


==========================================
 backend/src/routes/weather.js
==========================================
const express = require('express');
const router = express.Router();
const {
  fetchByCity,
  fetchByCoords,
  reformatOpenWeatherData
} = require('../weatherClient');

router.get('/', async (req, res) => {
  try {
    const { city, lat, lon } = req.query;

    if (!city && !(lat && lon)) {
      return res.status(400).json({ error: "Provide city OR lat & lon" });
    }

    let raw;
    if (city) raw = await fetchByCity(city);
    else raw = await fetchByCoords(lat, lon);

    const formatted = reformatOpenWeatherData(raw);
    res.json({ success: true, data: formatted });

  } catch (err) {
    if (err.response) {
      return res.status(err.response.status).json({ error: err.response.data.message });
    }
    res.status(500).json({ error: "Internal Server Error" });
  }
});

module.exports = router;


==========================================
 frontend/index.html
==========================================
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Weather App</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="app">
    <h1>Weather App</h1>

    <div class="search">
      <input id="cityInput" placeholder="Enter city..." />
      <button id="searchBtn">Search</button>
      <button id="useLocation">Use Location</button>
    </div>

    <div id="card" class="card hidden">
      <h2 id="cityName"></h2>
      <p id="desc"></p>

      <div class="details">
        <p><b>Temperature:</b> <span id="temp"></span></p>
        <p><b>Humidity:</b> <span id="humidity"></span></p>
        <p><b>Wind:</b> <span id="wind"></span></p>
        <p><b>Pressure:</b> <span id="pressure"></span></p>
      </div>

      <img id="icon" />
    </div>

    <p id="message" class="message"></p>
  </div>

  <script src="script.js"></script>
</body>
</html>


==========================================
 frontend/style.css
==========================================
(Use the same CSS you already have in your project.
Paste your full CSS here.)


==========================================
 frontend/script.js
==========================================
const API_BASE = "http://localhost:3001";

const cityInput = document.getElementById("cityInput");
const searchBtn = document.getElementById("searchBtn");
const useLocationBtn = document.getElementById("useLocation");
const card = document.getElementById("card");

const cityName = document.getElementById("cityName");
const desc = document.getElementById("desc");
const temp = document.getElementById("temp");
const humidity = document.getElementById("humidity");
const wind = document.getElementById("wind");
const pressure = document.getElementById("pressure");
const iconImg = document.getElementById("icon");
const message = document.getElementById("message");

searchBtn.addEventListener("click", () => {
  const city = cityInput.value.trim();
  if (!city) return showMessage("Enter a city name");
  fetchWeatherCity(city);
});

useLocationBtn.addEventListener("click", () => {
  navigator.geolocation.getCurrentPosition((pos) => {
    fetchWeatherCoords(pos.coords.latitude, pos.coords.longitude);
  });
});

async function fetchWeatherCity(city) {
  showMessage("Loading...");
  try {
    const res = await fetch(`${API_BASE}/weather?city=${city}`);
    const json = await res.json();
    if (!json.success) return showMessage(json.error);
    render(json.data);
    showMessage("");
  } catch (e) {
    showMessage("Network error");
  }
}

async function fetchWeatherCoords(lat, lon) {
  showMessage("Loading...");
  try {
    const res = await fetch(`${API_BASE}/weather?lat=${lat}&lon=${lon}`);
    const json = await res.json();
    if (!json.success) return showMessage(json.error);
    render(json.data);
    showMessage("");
  } catch (e) {
    showMessage("Network error");
  }
}

function render(d) {
  card.classList.remove("hidden");
  cityName.textContent = d.city;
  desc.textContent = d.description;
  temp.textContent = d.temperature + " Â°C";
  humidity.textContent = d.humidity + "%";
  wind.textContent = d.wind + " m/s";
  pressure.textContent = d.pressure + " hPa";

  iconImg.src = `https://openweathermap.org/img/wn/${d.icon}@2x.png`;
}

function showMessage(msg) {
  message.textContent = msg;
}

==========================================
 END OF FILE
==========================================